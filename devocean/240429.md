## ▶백엔드 없이 DB 사용하기 (MongoDB Atlas)

안녕하세요! 중간고사와 자격증 시험을 마치고 무사히 돌아왔습니다.😂  
혹시 여러분들도 간단한 토이프로젝트를 Netlify, Vercel, GithubPage와 같은 무료 배포 사이트를 통해 배포하고 싶은데, 그럴 때마다 DB를 사용하기 위해 구축한 백엔드를 어떻게 배포해야할지 고민한 적 있으신가요?

이번에 제가 가져온 주제는 MongoDB Atlas를 활용해서 백엔드 없이 프론트엔드만으로 간단하게 DB를 사용하고, 배포까지 해보는 활동을 다루어보려고 합니다!

목차
- 서론
- MongoDB Atlas 초기설정
- MongoDB API 사용

### 서론
저는 항상 간단한 웹 프로젝트를 만들려 할 때마다 DB를 활용하고는 싶은데 백엔드를 배포하려는 과정에서 과금없이 서비스를 이용하려하니 막막하기만 했었는데요, DB를 사용하지 않는 프로젝트라면 Netlify나 Vercel, Github Page와 같은 사이트를 통해 간단히 배포할 수 있지만, DB와 백엔드까지 포함된 프로젝트를 배포하고 싶을 땐 항상 과금걱정 없이 어떻게 백엔드를 배포해야 하나 고민이 많이 되더라구요.

그러던 중, 최근 MongoDB Atlas 공식홈페이지를 둘러보다 'Data API'라는 서비스가 존재하는 것을 알게되었고, 내용을 잘 읽다보니 API 형태로 Database에 접근하여 나의 DB에 저장된 데이터를 가져올 수 있어보였기에 혹시나 이를 활용한다면 Serverless 프로젝트를 구현할 수 있지 않을까 하여 저의 실험 프로젝트에서 연결하여 이를 테스트 해보았습니다.

MongoDB Atlas는 회원가입한 사용자에게 무료로 512MB 용량의 Cluster Database를 제공해주는데요, 카드를 등록하지 않아도 무료버전을 사용할 수 있었기에 과금걱정 없이 시도하기 좋은 플랫폼이라고 생각했습니다.  
원래 MongoDB Atlas를 사용하기 위해서는 node.js와 같은 백엔드 환경을 통해 mongodb 라이브러리를 설치하고, DB에 접속하기 위한 코드를 작성하여 연결해주는 방식으로 데이터베이스를 사용해야 합니다.  
저는 회원가입 이후 Cluster 생성까지는 동일하지만, Database를 직접 코드로 import하여 활용하는 것이 아닌 (프론트엔드에서는 연결을 시도하면 보안상의 이유로 거절당합니다.), MongoDB Atlas Data API를 활용하여 프론트엔드 환경에서 이를 사용했습니다.


### MongoDB Atlas 초기설정
1) 먼저 mongodb 홈페이지에서 회원가입을 하고, New Project 버튼을 눌러 새로운 프로젝트를 생성해줍니다.
2) Project를 생성했다면 프로젝트 대시보드가 생성되고, 'Create a deployment' 라는 문구와 함께 새로운 Database를 생성하기 위한 'Create' 버튼이 존재합니다.
3) Create 버튼을 누르면 Deploy할 Database type을 정해야하는데요, 우리는 과금없이 배포하는 것이 목표이기에 M10, Serverless, M0 중 무료인 M0을 선택하였습니다.
4) 이후 세부 설정은 취향에 맞게 설정한 뒤, 다음 단계로 넘어오면 두 번째 사진과 같은 Setup 화면이 나타납니다. 여기서 사용자아이디, 비밀번호를 설정하고 (해당 정보를 기반으로 DB에 접근할 수 있기에 꼭 기억해두셔야 합니다) 다음 화면으로 넘어갑니다.
5) 이렇게 유저 정보까지 생성했다면, 화면에는 백엔드에 Connect하기 위한 안내화면이 나오고 있을텐데, 저희는 프론트엔드에서 Data API를 사용할 예정이기에 이제 Close를 눌러 안내를 닫아도 됩니다.
6) 이제 대시보드의 좌측탭을 보시면 SERVICES 메뉴에 'Data API'라는 페이지가 있는데, 해당 버튼을 눌러서 이동해주고 생성했던 Database를 선택하여 Data API 기능을 활성화 시켜줍니다. (세 번째 사진 참고)
7) 이제 준비는 끝!! Data API에 적힌 URL Endpoint를 통해 만들어두었던 ClusterDB에 접근할 수 있습니다.


### MongoDB API 사용
이제 초기설정을 마치셨다면, Data API 페이지에 있는 URL Endpoint (https ://us-west-2.aws.data.mongodb-api.com/app/data-ftpwy/endpoint/data/v1) 를 활용하여 mongoDB action 명령어를 통해 데이터에 접근할 수 있습니다.

DB에 접근하기 위해 아까 초기세팅에서 생성했던 사용자아이디, 비밀번호를 통해 먼저 인증을 해야합니다.

🔽 사용자 인증을 위한 API 명세서
```
curl -X POST 'https://us-west-2.aws.services.cloud.mongodb.com/api/client/v2.0/app/data-ftpwy/auth/providers/local-userpass/login' --header 'Content-Type: application/json' --data-raw '{
  "username": "<USER_EMAIL>",
  "password": "<USER_PASSWORD>"
}'
```
![image](https://github.com/ChaeDoll/TIL/assets/108540812/8fadd20a-1c15-4c0b-9a00-c0835fa3f480)


<!-- 
MongoDB Atlas를 둘러보던 중, 프론트엔드(frontend) 환경에서 별도로 서버를 구축하지 않고 데이터베이스를 활용할 수 있는 방안을 찾아서, 토이프로젝트를 배포하고 싶은 분들에게 도움이 될 것 같은 내용을 들고와봤답니다. -->

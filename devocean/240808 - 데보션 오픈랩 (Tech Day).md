### 데보션 오픈랩 후기
2024.04.22 ~ 07.21 (3개월) 동안 실시한 10가지의 스터디.
하반기에도 또 시행할 예정임.
OpenLab OpenAPI... 이런 Open이라는 말들이 왜 나오기 시작했나? 전통적인 기업의 분위기에서 조금 더 개방적인 패러다임으로 나타난 개념이다.

10개의 스터디 모임, 102명의 개발자, 118건의 블로그
여기에 9개 세션/4개 포스터 . 프로젝트 부스도 있다.

OpenLab을 한 102명에게 피드백을 하면 **4.65/5.0**이었다. 다음 스터디 참여에 모두 다시하고싶다는 피드백이 있었다.
**좋았던 점**
- 현업 개발자와 함께 하기에.. 다양한 배경과 경험 가진 분들과 함께하여 더욱 다양한 관점에서 바라볼 수 있음.
- 퇴근 후의 자유로운 토론
- 현업에서의 고급기능, 실무운영 팁 등
- 스터디 운영자님들의 열정/노력
**개선할 점**
- 난이도 문제
- 장소, 온도 문제
- 오프라인 참여의 문제
- 식사 제공 여부, 쉬는 시간 등 사전 공지

6회째의 Tech Day 행사이다. 지금까지는 반나절밖에 안해서 TechDay라기에 애매했지만, 이번에는 10:00부터 18:00까지라 진짜 Tech Day이다
11시 40분쯤부터 점심시간 - 13:30부터 Part2 / 15시쯤부터 15:30까지 쉬는시간

**프로젝트 데모 부스**
Echo-Teddy
Lens
LLMEdubank
TGO(Travel GO)
직접 참여해봅시다.

# 목차
1) 개발자가 알아야 할 NAT, DNS
2) GraphRAG로 여행 100% 준비하고 떠나기
3) AI Travel Agent, Travel GO
4) 나는 왜 코프링 컨트롤러를 더 이상 만들지 않게 되었나?
## 1) 개발자가 알아야 할 NAT, DNS
**인프라 엔지니어 : 고재민**
DNS 동작방식과 도메인 위임, NAT 동작방식과 방화벽.. 
#### DNS란? Domain Name Service
- 사람이 읽을수있는 도메인 이름을 컴퓨터가 읽을 수 있는 IP주소로 변환하는 것.
- 클라우드 기반 인프라 구성이 많아지며 인프라가 빈번히 변경되어 DNS를 이용한 시스템 설계가 중요해지고 있음
- IP를 이용한것보다 도메인으로 많이 하고있음 (IP는 자주 변경될수있으니..)

blog. example. com.은
sub/second-level/top-level/root 순서이다.

**ipconfig/displaydns** : dns정보 확인가능
**ipconfig/flushdns** : 기존 로컬 DNS캐시를 비우고 새로운 도메인 정보를 가져올 수 있음 

Local에서 DNS 서버 요청을 보내고, DNS에서 해당 주소를 Root, Top-name, Cloud 순서로 탐색한다?

Local 캐시에 저장이 되어있는지 확인하고, 있다면 DNS서버는 바로 해당 웹사이트를 전달하고, DNS서버에서 해당 도메인 정보가 없다면 루트네임-탑레벨도메인-클라우드 순서로 
.com / example.com / blog.example.com 인가?

DNS 동작방식은 TTL과 DNS
- TTL이 짧을수록 도메인이 바뀌었을 때 이를 PC가 알아차리는 속도가 빠르다. 업데이트시에는 TTL설정을 짧게하고, 자주바뀌지 않는 도메인이면 TTL을 길게 변경할 수 있다.
- 하지만 쿼리를 자주해야하기에 DNS 서버에 부하가 증가한다. TTL이 길면 쿼리 자주 안해도 되지만 도메인 정보가 바뀌었을때 이를 알아차리지못함

**DNS 도메인 위임**
상위 도메인에서 하위 도메인의 네임서버를 지정하여 관리권한 넘겨주는것을 의미.
- 도메인을 위임하면 AWS, NCP 서로 다른 플랫폼으로도 사용할 수 있는것. 별도 운영 가능

**NAT란? Network Address Translation**
- 사설IP에서 공인IP로, 사설 IP에서 사설IP로, 공인IP에서 공인IP로 모두 NAT이다.
- 가정에서 인터넷을 사용하는 경우가 대표적인 예시이다. (공유기를 통함)
- 인터넷 공유기는 IP와 포트번호를 활용해서 SourceIP/Port 와 Destination IP/Port를 변환하는 테이블을 형성하여 사설주소를 갖는 컴퓨터의 네트워크를 공인IP로 활용하도록 할 수 있는 것.
**AWS에서의 SourceNAT, DestinationNAT**
- 프라이빗 서브넷인 EC2는 외부통신이 막혀있다. 따라서 NAT를 통해(SourceNAT) 외부 망에 연결하는 것이다.
- 로드밸런서를 이용하여 공인IP가 없는 EC2에 도달할 수 있도록 하는 것이 DestinationNAT이다.
**NAT와 방화벽**
- 개발 업무 하다보면 방화벽 신청을 할 때가 있는데, 연결이 되 안되다 할 때가 있다.
- 사내 NAT IP를 미리 파악해서 신청하면 네트워크 문제를 해결할 수 있다.
**정리**
- DNS를 활용한 온프레미스 + 클라우드 운영방법 (GSLB with 재해복구) / 멀티클라우드 환경을 구축할 수 있다.
- MSA, 쿠버네티스 환경에서의 Service Registry, Service Discovery
- DNS A레코드, CNAME 레코드
- NAT 이중화 시 방화벽 허용 잊지마세요.

DNS 위임은 서버 두대가 필요한데, 클라우드 환경에서 하기 좋다.
**질의응답**
1. 방화박 설정만으로도 기본적인 해킹 시도들은 막을 수 있나요? => 기본적으로 리눅스에도 FireWall이라는게있고, AWS에서도 보안그룹이라는게 있다. 해킹시도는 기본적으로 연결이 되어야하는데 SSH는 22번포트를 사용하는데, 특정 포트보다는 이렇게 포트를 변경한다면 좀 안전할 수 있다.
2. **포트포워딩도 NAT 과정인가요?** => 포트포워딩도 어떻게보면 공인IP를 사설IP로 매핑시키는데 어떻게보면 NAT과정이라 생각한다.
3. AWS Route53에 ns는 4가지로 등록되어있었는데, 스크린샷상 타 클라우드 ns에 등록할 때 2개만 등록하신것으로 보였는데, 4가지 모두 등록하지 않아도 문제되지않는지 => 4개가 있어도 각각 동작하는것이기에 전부 등록하지 않아도 각각 잘 동작하게된다.

## 2) GraphRAG로 여행 100% 준비하고 떠나기
**그래프 데이터사이언티스트 : 정이태**
- GraphRAG가 뭐지???
**여행 가기 전 100% 준비하고 있는지?**

고객을 세 분류로 나눈다면.. 혜택을 전혀 활용하지 못하는 고객, 로밍 어느정도 활용하는 고객, 엄청 활용하는 고객 => 왜 이런 고객들의 경우가 나타날까? 편의를 제공해야하는데! 왜 100% 챙겨주고싶어도 잘 안될까?
- 두 세대에게 질문했다. 원인은 무엇이냐..
- **중장년층** : 해외여행 가기전에 로밍 요금제. 114 전화하거나 공항부스 찾아간다. / Q. 인터넷으로도 충분히 가입할수있는데 시도해보겠어요? / 복잡해서 어려워요... 아들에게 부탁할래요 / Q. 혜택 받을수있는거 많아보이는데 활용할수있나요? / 아 그래요? 아들에게 부탁해야겠네
- **청년층** : 혜택을 고루고루 사용하는분 / Q. 어떻게 다 알고 했나? / Q.요금 혜택 이외에도 다른 혜택 모두 사용했는지? / 추가적인 혜택은 설명이 잘 이해가 되지 않아서 하지 않았다. 

두 세대를 아우르는 말. **복잡함**. 둘은 로밍 가입 경로가 다르다.
- 중장년층은 직접 전화 혹은 공항부스 방문. 금전적인것은 생각보다 크게 안고민
- 청년층은 앱으로 가입하고 혜택 적용안됐으면 상품 구매 안했을것이다.

우리가 여행갈때는 고민할것들이 너무 많다. 무슨 요금제쓸지 혜택 유무에 따라 또 달라지고..  혜택을 내가 받을수는 있는지...

내 멤버십 등급에서 이게 가능할지에 대해 고민해야하고.. 기존에 있는 가족결합과 로밍에 있는 가족결합이 별개이고 또 나눠져있는데(한정) 또 혜택 여행지에서 가능한지, 호텔/음식점/쇼핑/관광지/교통 등 어디에 사용가능할지... **너무 복잡하다.**

여행에서는 갈 때 생각할것이 너무 많은데 이것까지 언제 다 신경쓰면서 가는지! 로밍 혜택은 어쩌면 Minor한 부분이다. 그래서 에너지 쓰기 싫을수밖에없다.

**연관지어있는 것들을 연결하여 고객에게 혜택을 쉽게 보여주면 어떨까?**
분리되어 있지만, 사실 모두 연관되어있는 데이터들이다.. 그러면 연결해놓을 수 있다. 혜택들을 모두 연관지어줄수있는것.

로밍 혜택, 고객 정보, 멤버십 혜택 등 다 하나로 통합되어야함.
유저들끼리도 연결되고... 로밍, 멤버십 혜택 등.. 다 연결되고.. 
이런 것들을 **그래프 스키마로 연결한다**

**GraphRAG란??**
LLM계의 오픈북이라고 보면 된다. 책에서 우리가 찾아서 답변을 생성할텐데, LLM이 질문에 답변을하기 위해 데이터를 찾아서 가져와 답변하는것. (환각현상도 감소)
RAG와 GraphRAG의 차이는 가져오느냐 아니냐의 차이?
사용한다면!?
**가족결합 및 유저간 데이터 교류를 확인할 수 있어요.**
가족 결합이 가능한 사람이 누군지, 가족 결합시 얻게 되는 이익이 뭔지, 평소에 데이터를 선물하는 사람은 누구인지 (가족결합 여부 확인, 가족결합 혜택 확인, 평소 데이터 교류 인원 확인)
**여러 혜택을 한번에 알 수 있음**
도쿄로 여행갈 것이다. 라고하면 도쿄로 갈때 받을수있는 혜택을 요약해 볼 수 있음
오키나와의 호텔이나 식당 혜택 알려달라. 하면 해당 내용도 확인가능.  응용가능한 AI답변 가능
**로밍 요금 추천받을 수 있다.**
로밍 요금제 추천해주세요. 라고해도 받을 수 있고, 세부적으로 질문해서 이거랑 이거 차이를 알려달라! 해도 그거에 대해 답변해주고.. DB에 없는 내용은 없으면 없다. 있으면 있다고 얘기할 수 있다. 
실제로 이 요금제 쓰면 얼마정도 나오는지도 연산해서 답변해줄 수 있다. (유저 상황에 맞는 요금제 추천 / 요금제 별 장점 비교 / 평소 데이터 사용량 고려한 예상 요금 제시)

**비즈니스 상품화는 어떻게 가능한가**
고객입장에선 편의성과 가격만족도를 제공하여 고객유지&유치, 가족결합업셀링, 트래픽으로 이어짐.
혜택 제공자(업장) 입장에서는 이로인해 가격 경쟁력, 고객확보, 이는 곧 광고수익, 예약수수료 이익으로 이어짐.
팀마다의 비지니스 구조를 얻어낼 수 있을것으로 예상됨. 

**끝으로..**
AI덕분에 고객 개인니즈, 트렌드 및 비지니스 가속화가 되고있다.
인프라, LLM와 플랫폼 거장들이 말한것은 => 고객 개인화 LLM을 이야기하였다.

**질의응답**
**Q1.** 사용자가 GraphRAG를 활용하려면 직접 지식그래프를 구축할 수 있어야하나요? A. 요즘엔 쉽게 할 수 있다 클릭만으로.
**Q2.** 아들을 시키는것 중장년층 예시분은 여전히 사용안할것같다. A. 굉장히 간편화하면 그래도 사용할것같다.
**Q3.** 지식그래프에서 데이터 검색해 LLM에 넘겨줄 때 어떤 형식으로 넘겨주었나? A. 그래프의 형태를 그대로 넘겨주었다. 질의문을 생성해주는 LLM을 활용해서 그래프 형태로 Context를 넘겨주고 그 그래프를 이해해서 가져온것이다.
**Q4.** 각각의 데이터를 통합하는 과정... 다 그래프가 아니었을것같다. A. 그래프 형태로 만들기 위해 문제정의하는 곳에서 이렇게 연결될것이다! 라는 시멘틱을 만들고 (온톨로지 구축) 한마디로 문제적인 것으로 그래프 구축
**Q5.** 실제 서비스 개발 추론비용이 얼마나들었는지. A.추론 비용은 기껏해야 프롬프트 1000번정도 (1달러정도) 사용했다. 기존에서 Vector Indexing에서 가져오는대비 저렴했다.
**Q6.** 사용한 framework? A.Graph DBMS마다 철학이 다르다.(목적이 다름) 네오포지를 사용하였음. 랭체인도 사용하셨음. 왜 사용해야하는지에 대한걸 먼저 생각하였다.
**Q7.** GraphRAG에서 정보를 더 가져올지말지 결정은 LLM모델이 하나요? A. 어떤 흐름을 타는 라우팅이 중요하다. 하나의 LLM이 하기에 여러 것들을 통합하기에 어려울것인데, 따라서 각각 특화된 LLM을 선택하는과정(라우팅)이 중요하다. (어떤 모델에게 물어볼지) 모델은 GPT-4o모델을 써서 저렴하게 만들었다**.**
**Q8.** GraphDB구성에 비용적인 측면의 효율성? A. 벡터DB로 생각해보면 각각의 사일로마냥 다 비용부담? 그래프DB는 훨씬 저렴하다. Retrieve 소요시간은 1초 안쪽으로 소요된것으로 확인되었다.
**Q9.** GraphRAG 구축 위한 해당 도메인에 Prior Information이 반드시 필요? A. 철학에 따라 다르지만, 반드시 필요하다고 생각한다. 당위성이 있어야하는데, LLM이 이렇게 했다. 는 안된다?
Q10. 그래프 자체를 LLM으로 가져와서 LLM판단에 따라 답변이 나오는것인가요? A.네
Q11. 관리나 업데이트 부담은 어느정도? A. 데이터 통합이 잘 안되어있고 데이터 사일로가 명확하면, 처음 구축만해두면 온톨로지별로 활용가능해서 초반비용만 많이들지 장기적으로 좋다.
업데이트는...그래프DB를 NoSQL을 사용하게 되면 RDBMS, SQLDB에 비하면 간단하다. 부담이 적을것이라 예상된다.
Q12. 한번 질문시 최대 토큰은? 그래프 길어지면 토큰도 클것같다. A. 토큰 어떤LLM이든 Full로 해두고있다. 토큰을 길게해놓고 효율적인 답변을 주는것으로 상쇄할 수 있다고 생각한다. 그래프가 길어지는 경우 **프롬프트엔지니어링** **패스파인딩**을 토대로 질문이 좋은 질문인지 아닌지를 통해 토큰쪽을 활용할 수 있다.

## 3) AI Travel Agent, Travel GO
**여행서비스 스타트업 팀장 : 김하림**
여행준비를 Agent로 해결? 왜 Agent로..?
**LLMOps란?** Large Language Model + Operations
- LLM이 들어간 서비스인데, 처음부터 끝까지 고객한테 전달하고 관리하는 파이프라인을 구축하는것.
- 많은것을 공부해야하는데 RAG, Testing, Fine-tunning, Promp Engineering, Cost Optimization, Monitoring&Observability, Evaluation Metrics 등등...
공부에만 그치지 말고 실제 서비스를 만들어보고자 하였다.

**여행준비 왜 어렵나?**
단계가 정말 복잡하다... 쉽고 간단하지 않다.
- 완벽하고 싶은 욕구 - 여행가면 돈도들고 시간도 든다. 그렇게 제한된 자원에서 완벽하고 행복한 여행을 하고싶은 욕심이 크기 때문이다.  (가고싶은곳과 하고싶은일은 무궁무진) 이를 위해 조사를하는데, 점점 정보가 늘어난다.
- 많은 고객들이 여행 계획을 **노동**처럼 느낀다고 한다. 무려 16~20시간을 사용한다한다. GenZ세대들은 더욱 많이 사용다. 왜? **플랫폼이 다양해져서. 플랫폼마다 특징이 다르다**
- Z세대 여행시 정보탐색을 SNS, 유튜브로 많이하는데 유튜브는 동영상이기에 직관적으로 정보를 얻기 어려움. SNS에서도 바로 원하는정보가 나오지는 않는다. 

**정보 과잉. 선택의 어려움**

**이걸 Agent가 풀 수 있을 것이라 생각했다.**
Agnet란? 주변환경을 인지하고 상호작용하며 목표 달성을 위해 자율적으로 행동하는 시스템
즉, 목표에 맞게 Planning(계획세우기), Tools(어떤 도구를 사용할지; 검색해봐야해 혹은 API를 사용해야해 등), Action(예약같은 실제 행동으로 움직일수있고), FeedBack(지금 내 상황에서 더욱 필요한것을 파악)

하나의 Agent팀으로 구축
- 장소 추천 Agent (DB에 저장된 장소를 바탕으로 추천)
- 질문답변 Agent (신뢰할 수 있는 정보를 바탕으로 유용하고 정확한)
- 일정표 생성 Agent (동선까지 고려된 최적화된 일정 생성 및 맞춤형 체크리스트와 검증된 여행 팁 제공)

User Profile과 함께 Request에서 **숙박하기 좋은 호텔을 추천해주세요!** 라고하면 팀장 역할 Agent가? 장소추천 Agent를 선택한다. 
**장소추천 Agent가** 해당 상황에 맞는 장소를 추천함. (별점 몇점 이상, 후기에 아이가 많은 숙소를 찾아보자; DB와 인터넷검색) (SKT고객이다? 할인혜택은 있을까? GraphRAG 사용)

다음 질문으로 **식당 A에 가려고하는데 예약이 가능한가요?** 가 들어오면, 팀장이 질문답변 Agent로 이어줌. 마찬가지로 UserProfile을 토대로 답변함
질문답변 Agent가 DB&인터넷검색을 토대로 식당A에 대해 찾아보고 답변.. 

Request로 SKT 설립 날짜가 언제인가요? 여행 목적의 LLM이다. 따라서 이러한 목적과 다른 질문이다. 그러면 팀장이 안타깝게도 이 부분에 답변하기 어렵다는 말을 남길 수 있다. => 할루시네이션 방지

Request로 일정표 생성해달라고하면 일정표생성Agent가 이를 답변할 수 있음.

**그럼 결론은... 라우팅역할을 하는 Agent가 있고(팀장), 이들이 여러 LLM 모델들을 연결해주는 느낌 (상담사가 다른 부서로 연결해주듯)으로 활용이 가능하다.**
그러면 만능한 하나의 LLM보다 더욱 현실성있게 똑똑하게 사용가능할듯!
여러개의 특화된 LLM들을 통합하는 느낌?

**질의응답**
Q1. 뜬금없는 질문에 있어서 도움을 줄수없다고 프롬프트엔지니어링으로 응답하는데, 어떤 로직으로 구현가능? A. DB에서 정보를 찾을때 있는지 없는지 확인해서 답장하는것도 가능하고, 팀장Agent가 Classification을 통해 의도를 파악해서 우리가 답장가능한지 판단해서 답변할수도있다.
Q2. 에이전트마다 다른 LLM을 사용했나요? A. 여기서는 다 똑같은 LLM모델로 했는데, 복잡한 답변을 위해선 복잡한 LLM, 빠른답변을 원해선 가벼운LLM을 사용하는 방법도 있다.
Q3. Agent의 상호작용을 프롬프트로 제어하나요? A. agent들이 어떤식으로 상호작용할것인지 workflow를 미리 구축해놓고, 이걸통해 제어한다.
Q4. 에이전트 동작에는 대량의 토큰을 사용할것같은데, 토큰비용절감은 어떻게 고려하는지? A. 토큰을 절약하기보단 성능에 초점을 두려고 했다.
Q5. 처리 시간 지연은 불가피할것같은데 실시간성은 어떻게 확보하나요? A. 데모에서는 다 완성까지 기다리지만, 다음 목표는 실시간성을 보여주려한다.
Q6. 사용자가 답변에 만족하였는지는 어떻게 확인할 수 있나요? A. 고려가 안되어있는데, 후속질문이나 thumbsUP이나 thumbsDown으로 확인할수있게 할수도있다.
Q7. Agent 추천 서비스 가격이 저렴하지 않아 이탈이 일어나는 경엔 어떤식으로 개선할 수 있을까요? A. 고민해보고 올릴게요
Q8. 모호하고 추상적인 질문도 잘 대답하나요? A. 기법이 중요하다. 구체적인 질문으로 바꿔주는 방식으로 활용하면 될 수 있다. 
Q9. 국내와 해외여행지 정보 아우르는 DB구축을 위한 소스가 있었나요? A.힘들게 모아서 공개는 안되겠다 ^^.
Q10. 고객과의 대화 세션을 어느정도 유지? A.아직 메모리기능은..
Q11. 실제 서비스에서 OpenAI API를 활용해도 괜찮나요? 보안문제로 사용하기 어렵지않나요? A.앞으로 개선적으로는 파인튜닝한 모델을 사용할 예정이다.


근데 다들 OpenAPI써서 많이 한다. 본인이 직접 LLM을 만들어서 쓰는경우가 생각보다 .적네 당당하게 Gpt를 쓴다...신기.. 비용생각 크게 안하는구나..

**쉬는 시간**
ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
## 4) 나는 왜 코프링 컨트롤러를 더 이상 만들지 않게 되었나?
**백엔드 개발자(대학생) 김경환**
코틀린 스터디 소개, Open API, ...
데보션 영 3기 발표자이다.
코틀린 프로그래밍 언어와 프레임워크 이용하여 간단한 MVP REST API 개발하기. 대학생 2명, 현직자 9명, 서포터즈 1명

**Spring + Kotlin + OpenAPI** 활용한 프로젝트를 진행하였음. 그 중 오늘 이야기는 OpenAPI에 관한이야기.

기존의 프로젝트 커뮤니케이션.
- 백엔드가 API 개발하고 파라미터 수정해서 배포함 / 프론트가 개발 서버에 붙여서 개발을 진행.. 근데 에러가 발생. / 테스트를 돌렸을땐 잘됐는데??? 원인을보니.. API 명세서 최신화가 안되어있었다.. 그러면 최신화 후 알려주기
- API 명세서는 언제 수정하지?? 쉽게 수정하는 방법 없나? => **Swagger를 도입**. 많은 백엔드 개발자들이 사용하고 있음. Swagger 어노테이션 삽입하여 코드와 함께 API 문서를 관리, 생성 가능함.

Swagger를 기반으로 나온것이 바로 OPENAPI 이다. HTTP API를 위한 표준 인터페이스 정의.
기존의 Swagger Specification이 정착한것에서 OpenAPI가 시작되었음.
- 표준화 된 포맷 (JSNO 또는 YAML)
- 특정 언어나 프레임워크에 종속되지 않음 (유연성)
- 코드 생성 - **OpenAPI Generator**. 표준에 맞게 명세서를 만들어준다.

**OpenAPI Generator란?**  
OpenAPI 규격에 맞게 API를 표준화하게되면, StubServer(더미서버)를 생성할 수 있고, Client SDK로 자동으로 생성해줌. API를.. 더 쉽게. 메소드 형태로 API를 호출할 수 있음.
예시응답 또한 더미 Response로 자동 생성해준다.
결과적으로 Spec 파일로 API명세서 작성하여 효율적으로 운용 가능

Spec파일이란,(Swagger Editor로 확인가능)
먼저 openapi 사양
info에 문서기본정보기술
Server에 API서버들의 URL과 설명을 나열
tags
paths는 각 경로에서의 HTTP메소드,요청,응답 정의
components는 엔드포인트에 구성요소를 정의

1) 먼저 OpenAPI Generator Install을 해야함
2) 그리고 설치 말고 일회성으로 코드 생성하고 싶다면 Editor.swagger.io에서 spec파일을 import하여 Generate Client 탭으로 생성가능. (다양한 언어나 프레임워크 지원)
3) 생성한 코드를 살펴보면 apis, models가 생성됨.
4) Factory 패턴을 기반으로 SDK가 생성됨. 따라서 메소드 호출로 간편하게 API 연동이 가능하다. (하나의 메소드로 axios를 만들어주는 느낌?)
5) ServerSide Generation은 어떻게 이루어지는가?
# 7주차 - 섹션 2 중간 ~ 섹션 3

### 회원 도메인 실행과 테스트  
기본 자바로 구현하는 모습.  순수한 자바이고 스프링없이 해보았다.  
그런데 이 방식은 한계가 있음. 좋은 방식이 아니기에 Junit이라는 프레임워크를 사용할 것임  
요즘 코딩을 하려면 테스트 코드는 선택이 아닌 필수이다.  
join이라는 메소드를 테스트 코드를 통해서 검증해보았음.  
회원 도메인 코드가 설계 상 문제가 있을 것임. 무엇인가???  
다른 저장소로 변경할 때 OCP를 잘 준수할지, DIP는 잘 준수하는지.  
결국에는 한계가 있다. 구체화에 의존하는 문제가 있다...  

### 주문과 할인 도메인 설계  
회원은 상품을 주문할 수 있는데, 회원 등급에 따라 할인 정책이 달라지는 것.  
VIP의 경우 모든 상품에 1000원을 고정 할인해 줌. 근데 나중에 변경 가능.  
할인 정책은 변경 가능성이 높고 회사는 확신이 없다. 오픈 전까지 미루는 상황..  
이러한 미확정 상황에서 어떻게 해야할까?  
클라이언트의 주문 생성을 요청 => 주문 서비스는 회원의 ID를 조회하여 회원의 등급을 확인한다 => 그리고 회원 등급에 따라 할인을 적용 => 주문 서비스에서 할인 결과를 포함하여 주문 결과를 반환  
위 상황을 고려하여 할인 정책의 경우 여러 가능성을 구현체 여러개로 만들어 두고 구현체만 바꿔 끼우면 된다.  
( 보통 구현체가 단 하나만 있으면 interface명 뒤에 Impl이라고 적는 편이다.  
ex - OrderService 인터페이스의 구현체 OrderServiceImpl )  
이렇게 가능성을 만들어두고 갈아끼우면 주문서비스 쪽은 변경하지 않고 완성할 수 있다.  

### 주문과 할인 도메인 개발  
할인 패키지를 만들고 그 안에 할인정책 인터페이스를 만든 뒤, 고정금액할인 방식으로 구현한다. 차후 비율할인도 만들어 놓을 수 있음.  
주문패키지를 만들어 그 안에서 할인 비율에 따른 계산을 하여 결과값을 도출할 수 있도록 만든다.  
나중에 보기 편리하도록 toString()기능을 사용했다. 이러면 print로 order 객체만 출력하면 자동으로 toString 메소드가 실행된다.  
OrderService를 구현해야하는데 이곳에서 주문을 요청받을 때 클라이언트의 회원정보와 상품, 그리고 가격을 넘기게 된다.  
OrderServiceImpl에서 먼저 회원데이터베이스, 할인정책을 구현하고 (현재는 우선 메모리DB, 고정할인정책) OrderService의 주문생성 메소드를 오버라이딩한다.  
데이터베이스와 할인정책을 통해서 얻은 회원의ID, 아이템의 이름과 가격을 받은 뒤 이것들을 사용하여 Order객체에 이 값들을 포함시켜준다.  

### 주문과 할인 도메인 실행과 테스트  
메인, 테스트 둘다 테스트 해본 결과 문제 없이 잘 구현되었다.  
![image1](https://user-images.githubusercontent.com/108540812/217837600-9dbbcc53-f6b8-4549-a381-35e449c22a7f.png)  

## 섹션3  

### 새로운 할인 정책
섹션 6 - H2 데이터베이스  
데이터베이스 h2를 설치하고 이를 활용하는 방법에 대해 알아보았다. 기존엔 메모리에 데이터를 저장하는 방식으로, 서버가 종료되면 데이터도 삭제되는 휘발성 형식의 데이터였다.  
데이터베이스가 존재한다면 이러한 데이터들을 보존할 수 있을 것이고, 그를 위해 h2라는 프로그램을 이용하는 것이다. h2파일을 설치하고 h2.bat을 실행하여 프로그램에 접속할 수 있다. 윈도우 기준으로 h2.bat이고, 맥에서는 h2.sh를 실행한다고 한다.  
최초 접속에 성공하면 홈(cd ~)에 test.mv.db라는 데이터가 생성된다. 만약 h2를 초기화하고 싶다면 이 test.mv.db를 삭제한 뒤 다시 프로그램을 최초 실행시키면 초기화가 가능하다고 한다.  

순수 Jdbc는 build gradle 파일에 jdbc, h2와 관련된 라이브러리도 추가하고, 스프링부트 데이터베이스를 url을 통해 넣어야 한다.  
기존 코드를 건드리지 않고 Config파일만 수정하는 것으로 Repository를 변경할 수 있는데, 이것이 바로 스프링의 장점이다.  
스프링의 기본언어인 자바의 인터페이스 기능을 잘 활용한다면 OCP(개방폐쇄원칙)을 구현할 수 있다.  
Test를 할 때 @Aftereach 구문으로 Test가 돌 때마다 입력된 정보를 삭제하는 기능도 있는데, Rollback 기능을 사용하여 테스트를 다 하고 다시 초기상태로 돌아가는 방법도 있을 것이다 --> @Transactional 사용. 이러면 반복실행 테스트도 문제없이 구동된다.  
참고로 Transactional은 Test케이스에서만 동작한다.  
최소단위로 테스트하는 것을 단위테스트, 스프링 컨테이너를 포함하여 테스트하는것을 통합테스트라고 한다. 이왕이면 단위테스트가 더 좋은 경우가 많으니 참고.  

순수 스프링 Jdbc에 이어, 스프링 Jdbc템플릿에 대해 소개하자면 위에서 반복되는 코드들을 많이 제거해주는 것이라고 생각하면 편하다. 실무에서도 많이 사용하고 생성자 하나만 있다면 @Autowired도 생략 가능하다.  

여기에 더 얹어서 아직까지는 Sql을 개발자가 작성해야 하는데 그것까지(쿼리) 없앨 수 있는 JPA라는 것도 있다. 이를 사용하면 객체 중심 설계로 전환이 가능하고 개발생산성을 크게 높일 수 있게 된다. 국내에서도 JPA가 도입되며 점점 많이 사용되고 있다.  
하지만 JPA는 스프링만큼이나 활용하기 위해 공부해야 하는 양이 방대하기에 시간이 꽤 걸릴 수 있다.  
JPA는 쉽게 생각하면 자바 진영의 표준 인터페이스라고 생각하면 된다. JPA는 EntityManager이라는 것으로 모든 것을 동작시키는데, 이를 사용하면 멤버 등록이나 회원 조회 등 자동으로 쿼리를 등록해주기 때문에 매우 편리하다. 큰 회사들도 많이 쓰는데에는 다 이유가 있다.  

스프링부트와 JPA만 사용하더라도 개발 생산성이 많이 증가하지만, 만약 스프링데이터 JPA라는 것을 사용하면 인터페이스만으로 개발 완료가 가능할 정도로 엄청난 상황을 보여줄 수 있다.  
스프링데이터JPA라는 프레임워크로 반복을 정말 많이 줄여줄 수 있는데, 단순히 Repository에 SpringDataJpaRepository라는 인터페이스와 함께 JpaRepository와 MemberRepository를 상속받고, findByName이라는 메소드 하나만 오버라이딩하였는데 이것으로 SpringConfig에서 Bean을 등록하는 등 귀찮은 일이 모두 생략되었다.  
실무에선 관계형 데이터베이스 내에서 스프링데이터JPA는 선택이 아닌 필수일 정도로 널리 쓰인다.  
이 기술은 JPA를 편하게 쓸 수 있도록 도와주는 기술인 만큼 당연히 JPA에 대한 이해가 우선된다면 더욱 좋다.  
JPA, 스프링JPA를 기본으로 하고 복잡한 동적쿼리는 Querysdl이라는 라이브러리를 사용하는 것이 실무 추세이다.  

참고 - h2를 켜지 않으면 Intellij에서 아무리 스프링파일을 실행해도 에러가 뜰 것이다. h2를 데이터베이스 삼아 그 기반으로 동작하는 것이기 때문에 이를 켜두어야 올바른 실행이 가능하다.  

-----------------------------------------------------------------------  

섹션7 - AOP  
우리가 만약 여러 메소드들에 대한 호출 시간을 측정하려고 하면, 이를 위해 시간 측정 코드를 하나하나 모든 메소드에 추가해야하는 번거로운 상황이 발생할 것이다. 기껏 추가해놨더니 시간 측정에 관한 식을 수정해야하면 또 하나하나 수정해야한다.  
이렇게 공통 관심사에 대한 시간측정을 하는 등의 상황에서 더욱 효율적인 방법 위해 사용할 수 있는 것이 바로 AOP이다.  
AOP란 Aspect Oriented Programming의 약자로, 관점 지향 프로그래밍이라고도 할 수 있다.  
AOP에서는 공통 관심사항과 핵신 관심사항을 분리하여 관리하는 기술이다.  
이러면 시간 측정 로직을 만들어 놓고 이를 어느 대상에 적용할지만 택하면 된다.  
시간을 매우 아낄 수 있을 것이다.  
여기서 Aop로직에 @Around("execution(* hello.hellospring..*(..))") 라는 것을 붙이는데, hellospring파일 하위에 있는 모든 파일에 대해 이 로직을 적용시킨다는 뜻인듯 하다.  
AOP의 동작 이전에는 helloController->memberService->memberRepository 이렇게 실제 각 역할에 접근하여 동작하겠지만, AOP를 사용하면 프록시라는 임시(가짜)를 사용하여 프록시helloController->helloController --> 프록시memberServiece ... 이렇게 임시 역할에 접근하여 동작하고 이것의 동작이 마치면 joinPoint.proceed()를 통해 여러 경로를 타고 실제 서비스의 동작으로 이어진다.  
즉, 하나의 로직을 만들어놓고 특정 조건에 부합하는 메소드들에게 그 로직을 실행시킬 수 있게 되는 것이다.  

------------------------------------------------------------------------  

섹션8 - 마무리  
스프링의 모든 것을 다 알 필요는 없다. 우리는 스프링 언어 개발자가 아니고 이걸 활용하는 것이 주 관건이기 때문이다. 따라서 핵심 원리를 이해하고 문제가 발생했을 시에 어디서부터 접근해야할지 찾아 사용하는 능력이 더욱 중요하다.  
앞으로의 강의들은 실무에서 사용되는 것들 위주로 진행될 예정이다.  

스프링 입문 강의 끝
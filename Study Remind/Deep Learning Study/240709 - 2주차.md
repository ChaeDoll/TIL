### 4챕터 (136페이지 이후 이어서..)
### 학습 알고리즘 구현
**신경망 학습 절차**
신경망에는 갱신가능한 가중치, 편향이 있고 이들을 훈련 데이터에 적응하도록 조정하는 과정을 '학습'이라 한다. 학습의 단계는 4단계가 있다.
1. **미니배치** - 훈련 데이터 중 일부를 가져온다. 이렇게 가져온 미니배치를 토대로 손실함수를 계산하고, 그 값을 줄이는 것을 목표로 한다.
2. **기울기 산출** - 손실함수 값을 줄이기 위해 각 가중치 매개변수의 기울기를 구한다. (가중치 매개변수 변화에 따른 손실함수 값의 변화율) 기울기를 토대로 손실 함수 값을 작게 하는 방향을 제시할 수 있다. 만약 전체 W의 기울기가 음의 기울기면 양의 방향으로, 양의 기울기면 음의 방향으로 갱신하여 가중치에 따른 손실 함수 변화율이 최소가 되기 위한 방향을 찾는다. (손실함수 변화율이 작다는 것은, 기울기가 0인, 즉 최소값이라는 뜻이기에 그렇다.)
3. **매개변수 갱신** - 가중치 매개변수를 기울기 방향을 토대로 아주 조금 갱신한다.
4. **반복** - 1부터 3까지의 과정을 반복한다.
이 과정이 경사 하강법을 활용하여 매개변수를 갱신하는 방법이다. 이 때 미니배치를 무작위로 선정하기에 **확률적 경사 하강법(Stochastic Gradient Descent; SGD)** 라고 한다. 대부분의 딥러닝 프레임워크는 SGD 함수로 이 기능을 구현하고 있다.

#### 실제 MNIST 데이터셋을 활용한 학습
교재의 Github 04chatper의 two_layer_net 코드를 활용했다. 입력되는 값들과 (28x28이라 정규화(0부터 255사이) 된 784개의 값이 입력됨.) 출력값 (0부터 9까지 중 하나로 예측)을 입력하고 은닉층 개수인 hidden_size를 적절히 입력한다.
이 코드에서 loss function은 교차 엔트로피 오차를 사용했다.
numerical_gradient 메소드는 수치미분 방식으로 매개변수 기울기를 구하는 메소드이다.
오차역전파를 활용한다면 더욱 빠르고 효율적으로 기울기를 계산 가능함 - 이후 챕터에서 배울 예정임. 오차역전파법을 활용하면 수치미분으로 구하는 것과 거의 같은 결과를 매우 빠르게 얻을 수 있음. 

##### 미니배치 학습 구현
ch04 train_neuralnet.py 코드를 활용하여 미니배치 학습을 본다. 입력 784, 은닉층 50개, 출력층 10으로 두었다.
np.random.choice(전체크기, 배치크기)를 활용해 미니배치를 얻고, 수치미분을 활용한 기울기를 구하고, 이를 통해 learning_rate에 비례해 매개변수를 조정한다. 그리고 각 배치에서의 loss를 저장 및 출력한다.
이 코드에서는 이러한 과정을 10000번(iters_num) 만큼 반복하여 기울기 계산 및 가중치,편향 갱신을 반복하였다. 학습율은 0.1로 하였다.
이렇게 만들어진 loss list는 그래프로 train과 test의 정확도를 나타낸다. 1회 반복당 (에폭) 정확도가 어떻게 향상되는지 보여준다.
##### 시험 데이터로 평가
신경망 학습에서는 훈련 데이터 외 데이터를 잘 인식하는지 확인해야함. '오버피팅'되면 훈련데이터는 잘 식별하겠지만 그 외의 시험 데이터를 잘 식별하지 못할 수 있다.
**에폭** : 1에폭은 학습에서 모든 훈련데이터를 소진했을 때를 의미함. 10000개를 100개 미니배치로 학습하면, SGD를 100번 반복한다면 데이터 10000개를 다 소진할 것이다. 이것이 1에폭이다.
다행히 이번 코드에서는 훈련데이터 뿐만 아니라 시험데이터도 함께 정확도가 올라가고 있다. 이는 좋은 경우이다.

### 정리
- 기계학습은 데이터셋을 훈련 데이터 / 시험 데이터로 나누어 사용함\
- 훈련 데이터로 학습하고, 범용 능력을 시험 데이터로 평가한다.
- 신경망 학습은 손실함수를 토대로 손실함수 값이 작아지는 방향으로 (기울기를 통해) 가중치 매개변수를 갱신함.
- 가중치 매개변수 갱신에는 가중치 매개변수의 **기울기**를 이용. 기울어진 방향으로 가중치 값을 갱신하는 작업을 반복함 (정확히는 반대방향이겠지?? +방향으로 기울어져있다면 음의 방향으로, -로 기울어져있다면 양의 방향으로 움직이면서 최종적으로는 기울기가 0에 가깝게...)
- 아주 작은 값 주어질 때 차분으로 미분하는것? 수치미분 (f(x+h) - f(x) / h 로 구하면 전방차분, f(x+h) - f(x-h) / 2h 로 구하면 x중심으로 전후 차분을 구한다하여 중심차분(중앙차분)이라 함)
- 수치 미분으로 가중치 매개변수 기울기 구할 수 있음
- 수치 미분 사용하면 계산은 시간 걸리지만 구현이 간단. 오차역전파를 사용하면 구현은 복잡하지만 기울기를 고속으로 구할 수 있음.
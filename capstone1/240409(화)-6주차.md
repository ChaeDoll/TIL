## 프론트엔드
- 예정
    - 사용자 방명록 작성 기능 구현
    - 사용자 방명록 삭제 기능 구현
    - 사용자 닉네임 변경 기능 구현
    - 채팅 말풍선 모양 및 내부 요소 모양 개선
    - 채팅창 상단이 흐려지도록 투명 그라데이션 구현


- 채팅창 하단 창에서 시작할 수 있도록 설계
![image](https://github.com/ChaeDoll/TIL/assets/108540812/81d4dbf9-385e-4fb9-94a9-d4ce0bf91c5f)

- 스크롤 문제 해결하는 과정... Trouble Shooting
- 자고 일어나서 setInterval를 통해 실시간 채팅방을 불러올 예정이다.

### 구현 방안
- 생각해보니 댓글이 정말 많은 상황에서는 페이징 기능이 필요함. 그렇다면 ScrollView의 길이가 정해져도 되지 않을까? 처음 ScrollView의 길이가 정해지고, 오버스크롤을 하면 새로운 댓글이 불러와지면서 일정 길이만큼 증가하는 방식? 나쁘지않다!
- 또한 굳이 채팅방을 누를때마다 새로고침 하지 않아도 될 것 같다. 일정 상단 위로 올라가면 '하단으로 이동' 버튼을 띄우게하면 될듯

- 상단 그라데이션 구현 완료  
<img src="https://github.com/ChaeDoll/TIL/assets/108540812/c9fc0f30-1426-4278-b7f7-75d96fc45bf1" width="80%"/>
<img src="https://github.com/ChaeDoll/TIL/assets/108540812/85a4d860-d703-4a54-98df-bec095a092fc1" width="17%"/>

## 백엔드
- 페이징 기능 구현 성공 (백엔드)
    - 이 덕분에 이제 고정적인 ScrollView 높이를 가질 수 있게 되었다. => 새로고침 될 때마다 Content 크기 * 개수만큼만 높이 높여주면 된다.

![240409-2](https://github.com/ChaeDoll/TIL/assets/108540812/832aaa8a-f483-435b-9e9e-e6989890c60a)  
![240409-3](https://github.com/ChaeDoll/TIL/assets/108540812/f9d7d468-47c6-46ca-b73c-a083e0fe4c38)  
![240409-4](https://github.com/ChaeDoll/TIL/assets/108540812/02ff59ea-584b-45cb-bdf7-fae034564ac9)  


### 추후 구현
- 스크롤 끝까지 가면 추가로 Page+1 하여 Comment 가져오기
- ScrollView 고정길이로 지정 후, Comment 가져오면 가져온 Comment개수만큼 길이 늘려주기
- 위와 더불어 채팅창에 처음 들어올 때 최하단으로 시점 보여주기 (고정 ScrollView라서 가능할듯) (완료)
- 너무 위로 올라가면 '하단으로 이동' 버튼 나타나기
- 방명록 작성 기능 (완료)
- 방명록 삭제 기능 (부분 완료)
- 닉네임 변경 기능 
- 채팅 메세지 디자인 변경 (완료?)

### Comment 내림차순으로 아래에 보이도록 구현
- 메세지를 날짜 내림차순 순서로 가져오고싶은데, 자꾸 위에서 아래로 보여주는 문제...
- Paging 할 때 createDate를 기준으로 Sorting 하였으나 잘 가져오긴 하는데 그걸 프론트에서 보여주면 결국 화면 위에서 아래로 보임.
- 프론트에서 배열을 reverse()한 뒤, map함수로 화면에 구현하려 하였으나 첫 reload시에는 reverse되지 않은 결과를 보임. (아마 로딩 시간때문?)
- 백엔드에서 문제를 해결하려 노력을 많이 기울였는데... 결국 똑같은 결과만 주구장창 나오기 마련...
- 프론트엔드에서 해결하는 방법이 없을까 더 찾아보던 도중, ScrollView의 contentContainerStyle의 flexDirection을 'column-reverse'로 설정하면 된다는 말을 듣고 이를 실행함. .. 진짜 해결됐다.

### 방명록 작성 기능
- 구현완료. 방명록을 작성완료하면 ScrollView가 scrollToEnd된다. 자동으로 아래로 이동해서 본인이 쓴 글을 볼 수 있게 함.

### 방명록 setInterval 구현
- 다른 사람이 입력한 채팅도 받아오기 위해서는 setInterval과 같은 Listener를 통해 주기적으로 CommentList를 가져와야 했다.
- 이전에는 페이징도 안되어있어서 가져오는게 부담이 됐지만, 이제는 페이징도 되어있기에 0.3초 간격으로 글을 가져오도록 설정했다.
- ~~또한, 이렇게 일정 간격으로 글을 가져온다면 굳이 글을 작성했을 때 다시 getComment를 요청할 필요가 없어서 이를 제외시켰다.~~ => 다시 불러오게 했다. 어차피 0.3초마다 요청하는데 댓글 작성할때마다 요청 +1 시킨다고 크게 달라지는것도 없고, postComment 완료 후 바로 getComment가 이루어지면 사용자가 느끼기에 바로 내가 작성한 Comment가 작성되는데, 0.3초의 경우엔 운이 안좋으면 너무 느리게 반응하는게 좀 아쉬웠다.
- **차라리 postComment시에 바로 getComment를 요청하고, Interval 간격을 0.5초로 늘리는게 더 효율적이라는 결론에 이르렀다.**

### 방명록 삭제 기능
- 방명록을 Pressable로 바꾸고, onLongPress를 통해 메세지를 꾹 눌렀을 때 작동하는 로직에 방명록 삭제 기능을 넣었다.
- 다른사람의 방명록을 꾹 눌러도 삭제되는 오류가 생겼다.
    - 프론트에서 comment 작성자의 닉네임과 사용자 본인의 닉네임을 비교하여 같을때만 삭제 기능을 동작하도록 설정하였다.
- 다른 사람의 방명록을 누르면 그사람의 닉네임이 나타나도록 해야할 것 같다.
- **추가로 Modal창을 통해 확인, 취소창이 떠야할 것 같다. 갑자기 냅다 삭제시켜버리니까 좀 당황스러울 수 있을 것 같아서...**

### 별거 아닌데.. 음악 여러번 로딩되는거 해결
- 음악 여러번 가져오는 버그를 어떻게 고칠까했는데, dataList가 존재하지 않을때만 실행시키게했더니 여러번 실행되는게 사라졌다. 혹시나 했는데 다행이다
## 스프링 핵심 원리 - 기본편 섹션6 복습  
### 탐색 위치, 기본 스캔 대상
설정정보에서 컴포넌트 스캔을 하는데 basePackages를 통해 시작 위치를 설정할 수도 있지만, 꼭 설정을 따로 하지 않더라 해도 기본적으로 컴포넌트스캔이 이루어지는 파일이 존재하는 패키지가 기본시작 위치가 된다.  
이를 사용해서 현재 실무에서 자주 사용하는 방식은 프로젝트의 최상단에 AppConfig와 같은 설정 파일을 두고, 최상단에서 ComponentScan을 실행하여 프로젝트에 필요한 부분을 전체적으로 스캔하는 방식이다.  
이렇게 스캔을 하면서 필요하지 않은 것들은 excludeFilters를 통해 대상에서 제외한다.  

입문강의에서 @Controller라던가 @Service라던가 이러한 기능들도 컴포넌트처럼 자동으로 인식되는 애노테이션으로 알 수 있었을 것이다.  
이것들은 사실 정의될 때 @Component가 들어있기 때문에 똑같은 기능을 하는 것이다.  
> 착각하면 안되는데, 애노테이션은 상속관계가 없고 연동되거나 그런 기능이 있는게 아니다. 이것은 자바언어가 아닌 '스프링'에서 지원하는 기능으로 알고 있으면 된다.  

위에 @Controller처럼 여러 애노테이션들도 @Component 기능도 한다고 했다. 이것들은 컴포넌트 기능 뿐만 아니라 각각 추가적인 부가기능을 갖고있다.  
물론 @Service는 특별한 처리를 하지는 않지만 개발자들이 핵심 로직들이 들어있는 서비스 계층이라는 것을 인지할 수 있게 해줄 것이다.  
<hr>  

### 필터  
위에서 excludeFilters를 언급했었다. 말 그대로 스캔대상에서 제외하는 필터인데 이것 외에도 includeFilters라는 것도 있다.  
제외된 대상을 getBean하게되면 NoSuchBeanDefinitionException 에러가 발생한다.  
junit의 Assertions.assertThrows를 사용하여 에러가 잘 발생하는지 테스트하면 잘 검증될 것이다.  
필터 옵션은 5가지가 있다.  
- ANNOTATION :기본값, 생략가능  
- ASSIGNABLE_TYPE : 지정한 타입, 자식 타입을 인식하여 동작  
- ASPECTJ : ASPECTJ 패턴 사용  
- REGEX : 정규 표현식  
- CUSTOM : TypeFilter이라는 인터페이스를 구현해서 처리  

포함시키는 것은 @Component면 충분하기에 includeFilters는 잘 안쓴다. 그 대신 여러 제외해야할 상황일 때 excludeFilters를 가끔 쓸 뿐이다.  

### 중복등록, 충돌  
같은 이름의 빈이 2개 있는데 이를 컴포넌트스캔으로 자동등록 하려고 하면 어떻게 될까 -> ConflictBeanDefinitionException 발생  
수동으로 등록한 빈 1개, 자동으로 등록된 빈 1개 이렇게 같은 이름으로 등록이 되면 어떻게 되는가? (가끔 있을 수 있는 일이다)  
실제로 실행시켜보면, 수동빈이 자동빈을 오버라이딩 해버린다. 테스트 결과 오류는 나타나지 않음  
로그에도 Overriding 되었으며 replacing 되었다고 남는다.  
로그에 남으면 문제가 없을까? 사실 의도적으로 이런 방식을 만든 것이면 모를까, 보통 의도하지 않게 이런 결과가 되어버리는 것이다. 오히려 테스트에 오류도 안떠서 잡기 어려운 애매한 버그가 되어버리는 것이다.  
그래서 최근에는 스프링 부트에서 수동빈과 자동빈이 겹치면 충돌이 나도록 기본값을 변경했다.  
테스트에선 문제 없더라도 스프링부트 애플리케이션을 실행시켜보면 에러메세지가 나타날 것이다.  
만약 진짜 오버라이딩 되도록 의도한것이다? 설정을 통해 변경할 수 있도록 만들어두었다. (친절한 스프링^^)  
하도 이런 오류로 인해 개발자들이 골치아프니까 오죽했으면 기본설정을 이렇게 변경해버린 것이다. 애매한 상황을 만들지 않으려 한 것!  
코드가 최적화되지만 애매한 표현이 된다? 어설픈 추상화가 된다? 그런거 나중에 미래를 위해 지양하는게 좋다. 코드를 좀 더 쓰더라도 더 명확하고 빠르게 오류를 낼 수 있게 방향을 설정하는 것이 좋다.  

## 섹션7 복습  
### 의존관계 주입 관련  
